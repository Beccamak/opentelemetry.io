

<div class="">
    <div class="d-flex justify-content-between my-3">
        <h4>{{ .Title }}</h4>
        <a href="?s={{ .SearchTerm }}&component=&language=">View All</a>
    </div>
     <div class="d-flex flex-column flex-sm-row justify-content-between" style="gap:12px">
        {{ $searchTerms := .SearchTerms }}
        {{ $resultCount := 0 }}
        
        {{ range .registry }}
            {{ $entry := . }}
            {{ $matched := false }}
        
            {{ range $searchTerms }}
                {{ if or (in $entry.title .) (in $entry.description .) (in $entry._key .) (in $entry.tags .) (in $entry.package.name .) (in $entry.flags .) (in $entry.license .) (in $entry.language .) (in $entry.registryType .) }}
                    {{ $matched = true }}
                {{ end }}
            {{ end }}
        
            {{ if and $matched (lt $resultCount 3) }}
                {{ $resultCount = add $resultCount 1 }}
                {{/* Define variables */}}
                {{ $remoteRegistries := dict 
                    "npm" (dict 
                        "urlPattern" "https://npmjs.com/package/%s"
                        "installTemplate" "ecosystem/registry/quickinstall/default.md"
                        "installLine" "npm install %s"
                        "icon" "fab fa-npm")
                    "packagist" (dict
                        "urlPattern" "https://packagist.org/packages/%s"
                        "installLine" "composer require %s"
                        "installTemplate" "ecosystem/registry/quickinstall/default.md"
                        "icon" "fa-solid fa-box-open")
                    "gems" (dict
                        "urlPattern" "https://rubygems.org/gems/%s"
                        "installLine" "gem install %s"
                        "installTemplate" "ecosystem/registry/quickinstall/default.md"
                        "icon" "fa-solid fa-gem")
                    "go" (dict
                        "urlPattern" "https://pkg.go.dev/%s"
                        "installLine" "go get %s"
                        "installTemplate" "ecosystem/registry/quickinstall/default.md"
                        "icon" "fa-brands fa-golang")
                    "nuget" (dict
                        "urlPattern" "https://www.nuget.org/packages/%s"
                        "installLine" "dotnet add package %s"
                        "installTemplate" "ecosystem/registry/quickinstall/default.md"
                        "icon" "fa-solid fa-box-open")
                    "pip" (dict
                        "urlPattern" "https://pypi.org/project/%s"
                        "installLine" "pip install %s"
                        "installTemplate" "ecosystem/registry/quickinstall/default.md"
                        "icon" "fa-brands fa-python")
                    "hex" (dict
                        "urlPattern" "https://hex.pm/packages/%s"
                        "installTemplate" "ecosystem/registry/quickinstall/hex.md"
                        "icon" "fa-brands fa-erlang")
                    "crates" (dict
                        "urlPattern" "https://crates.io/crates/%s"
                        "installLine" "cargo add %s"
                        "installTemplate" "ecosystem/registry/quickinstall/default.md"
                        "icon" "fab fa-rust")
                -}}
        
                {{/* Initialize variables */}}
                {{ $isNative := and (or (eq $entry.registryType "instrumentation") (eq $entry.registryType "application integration")) ($entry.isNative) }}
                {{ $isFirstParty := and (or (eq $entry.registryType "instrumentation") (eq $entry.registryType "application integration")) ($entry.isFirstParty) }}
                {{ $currentTime := time.Now }}
                {{ $delta := $currentTime.Sub (time.AsTime $entry.createdAt) }}
                {{ $isNew := lt $delta.Hours 730 }}
                {{ $usedInDemo := and (isset $entry "urls") (isset $entry.urls "demo") }}
                {{ $deprecated := and (isset $entry "deprecated") (isset $entry.deprecated "reason") }}
                {{ $package := "" }}
                {{ if and ($entry.package) (isset $remoteRegistries $entry.package.registry) }}
                    {{ $package = merge $entry.package (index $remoteRegistries $entry.package.registry) }}
                    {{ $package = merge $package (dict "type" $entry.registryType) }}
                {{ end }}
                {{ $highlightStyle := "" }}
                {{ if $isNew }}
                    {{ $highlightStyle = "border-info" }}
                {{ end }}
                {{ if $isNative }}
                    {{ $highlightStyle = "border-success" }}
                {{ end }}
                {{ if $isFirstParty }}
                    {{ $highlightStyle = "border-success" }}
                {{ end }}
                {{ if $usedInDemo }}
                    {{ $highlightStyle = "border-secondary" }}
                {{ end }}
                {{ if $deprecated }}
                    {{ $highlightStyle = "border-danger" }}
                {{ end }}
                {{/* Define $primaryHref */}}
                {{ $primaryUrl := "" }}
                {{ if $entry.urls.repo }}
                    {{ $primaryUrl = $entry.urls.repo }}
                {{ else if $entry.urls.website }}
                    {{ $primaryUrl = $entry.urls.website }}
                {{ else if $entry.urls.docs }}
                    {{ errorf "The %q registry entry requires a repo or website URL." $entry.title }}
                {{ end }}
                {{ $primaryHref := printf "href=%q" $primaryUrl | safeHTMLAttr }}
           
                <li class="card registry-entry {{ $highlightStyle }}" data-registry-id="{{ $entry._key }}" data-registrytype="{{ $entry.registryType }}" data-registrylanguage="{{ $entry.language }}" style="flex:1">
                    <div class="card-body container">
                        <h4 class="card-title mb-0 d-flex flex-row">
                            <a {{ $primaryHref }} target="_blank" rel="noopener" class="me-auto">
                                {{- $entry.title | markdownify -}}
                            </a>
                        </h4>
                        
                        <p class="card-text">
                            <small class="text-body-secondary">
                            by 
                            {{ range $index, $author := $entry.authors -}}
                                {{ if $index }}, {{ end }}
                                {{ if eq $author.name "OpenTelemetry Authors" -}}
                                    <a href="/" class="badge rounded-pill text-bg-primary">ðŸ”­ {{ $author.name }} ðŸ”­</a>
                                {{ else if isset $author "url" }}
                                    {{ $href := printf "href=%q" $author.url | safeHTMLAttr -}}
                                    <a {{ $href }} target="_blank" rel="noopener" class="card-link external-link p-2">{{ $author.name }}</a>
                                {{ else -}}
                                    {{ $author.name -}}
                                {{ end -}}
                            {{ end -}}
                            </small>
                        </p>
                        <div class="ms-auto">
                            {{ if $isNew -}}
                                <span class="badge rounded-pill text-bg-info"><i class="fa-regular fa-star"></i> new</span>
                            {{ end -}}
                            {{ if $isNative -}}
                                <span class="badge rounded-pill text-bg-success text-white"><i class="fa-solid fa-puzzle-piece"></i> native</span>
                            {{ end -}}
                            {{ if $isFirstParty -}}
                                <span class="badge rounded-pill text-bg-success text-white"><i class="fa-solid fa-heart"></i> first party integration</span>
                            {{ end -}}
                            {{ if $usedInDemo -}}
                                <span class="badge rounded-pill text-bg-secondary text-white" title="This package is used in the OpenTelemetry Demo!"><i class="fa-solid fa-shapes"></i> OTel Demo</span>
                            {{ end -}}
                            {{ if $deprecated -}}
                                <span class="badge rounded-pill text-bg-danger text-white" title=""><i class="fa-solid fa-ban"></i> deprecated</span>
                            {{ end -}}
                            {{ if $entry.cncfProjectLevel -}}
                                <span class="badge rounded-pill text-bg-primary text-white" title="CNCF {{ $entry.cncfProjectLevel }} Project">
                                    <img alt="CNCF" style="display: inline-block; width: 14px; height: 14px; border: none; margin:0px; padding: 0; vertical-align:middle" src="/img/cncf-icon-white.svg"> {{ $entry.cncfProjectLevel }}
                                </span>
                            {{ end -}}
                        </div>
                        <div class="col">
                            <div class="">
                                <div class="mb-3">
                                    {{ if $deprecated -}}
                                        <div class="alert alert-danger" role="alert">
                                            <h4 class="alert-heading">Deprecated</h4>
                                            {{ $entry.deprecated.reason | markdownify }}
                                        </div>
                                    {{ end -}}
                                    {{- $entry.description | markdownify -}}
                                </div>
                                
                                {{ with $package -}}
                                    {{ if not (eq .quickInstall false) }}
                                        <h6><i class="fa-solid fa-forward"></i> Quick Install</h6>
                                        <p>{{ (partial .installTemplate .) | markdownify -}}</p>
                                    {{ end -}}
                                {{ end -}}
                            </div>
                            
                            <div class="">
                                <ul class="list-group list-group-flush">
                                    {{ if $entry.package.version -}}
                                        <li class="list-group-item p-0">
                                            <div class="me-auto">
                                                <div class="fw-bold">{{ $entry.package.version }}</div>
                                                <small>Version</small>
                                            </div>
                                        </li>
                                    {{ end }}
                                    {{ if $entry.language -}}
                                        <li class="list-group-item p-0">
                                            <div class="me-auto">
                                                <div class="fw-bold">{{ $entry.language }}</div>
                                                <small>Language</small>
                                            </div>
                                        </li>
                                    {{ end }}
                                    {{ if $entry.license -}}
                                        <li class="list-group-item p-0">
                                            <div class="me-auto">
                                                <div class="fw-bold">{{ $entry.license }}</div>
                                                <small>License</small>
                                            </div>
                                        </li>
                                    {{ end }}
                                </ul>
                            </div>
                        </div>
                    </div>
                    {{ with $entry.urls.website -}}
                        {{ $websiteHref := printf "href=%q" . | safeHTMLAttr -}}
                        <a {{ $websiteHref }} target="_blank" rel="noopener" class="card-link"><i class="fas fa-house" aria-hidden="true"></i>&nbsp;Website</a>
                    {{- end -}}
                    {{ with $entry.urls.docs -}}
                        {{ $docsHref := printf "href=%q" . | safeHTMLAttr -}}
                        <a {{ $docsHref }} target="_blank" rel="noopener" class="card-link"><i class="fas fa-book" aria-hidden="true"></i>&nbsp;Documentation</a>
                    {{- end -}}
                    {{ with $package -}}
                        {{ $packageUrl := printf "href=%q" (printf .urlPattern .name) | safeHTMLAttr -}}
                        <a {{ $packageUrl }} target="_blank" rel="noopener" class="card-link"><i class="{{ .icon }}" aria-hidden="true"></i>&nbsp;Package Details ({{ .registry }})</a>
                    {{- end -}}
                    {{ with $entry.urls.repo -}}
                        {{ $icon := cond (hasPrefix . "https://github.com/") "fa-brands fa-github" "fab fa-git-alt" -}}
                        {{ $repoHref := printf "href=%q" . | safeHTMLAttr -}}
                        <a {{ $repoHref }} target="_blank" rel="noopener" class="card-link"><i class="{{ $icon }}" aria-hidden="true"></i>&nbsp;Repository</a>
                    {{- end -}}
                    {{ with $entry.urls.demo -}}
                        {{ $demoUrl := printf "href=%q" . | safeHTMLAttr -}}
                        <a {{ $demoUrl }} target="_blank" rel="noopener" class="card-link"><i class="fa-solid fa-shapes" aria-hidden="true"></i>&nbsp;Demo Service</a>
                    {{- end -}}
                </li>
            {{ end }}
        {{ end }}
    </div>

</div>
